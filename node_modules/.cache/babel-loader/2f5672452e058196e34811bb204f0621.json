{"ast":null,"code":"var _jsxFileName = \"/Users/yolo/Documents/dev/js/faceid/src/components/Login.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { useAuth } from \"../hooks/useAuth\";\nimport { useFace } from \"../hooks/useFace\";\nimport { loadModels, getFullFaceDescription, createMatcher } from \"../api/face\";\nimport Copyright from \"./Copyright\";\nimport Webcam from \"react-webcam\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Card from \"@material-ui/core/Card\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WIDTH = 420;\nconst HEIGHT = 420;\nconst inputSize = 160;\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main\n  },\n  form: {\n    width: \"100%\",\n    // Fix IE 11 issue.\n    marginTop: theme.spacing(1)\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  }\n}));\n\nfunction FaceReco() {\n  _s();\n\n  const webcam = useRef();\n  let videoConstraints = {\n    width: WIDTH,\n    height: HEIGHT\n  };\n  const {\n    users\n  } = useFace();\n  const [faceMatcher, setFaceMatcher] = useState([]);\n  const [user, setUser] = useState(null);\n  useEffect(() => {\n    if (users.length !== 0 && faceMatcher.length === 0) {\n      loadModels().then(async () => {\n        setFaceMatcher(await createMatcher(users));\n      });\n    }\n\n    if (faceMatcher.length !== 0) {\n      const interval = setInterval(() => {\n        capture();\n      }, 500);\n      return () => clearInterval(interval);\n    }\n  }, [users, faceMatcher]);\n\n  const capture = () => {\n    if (!!webcam.current) {\n      getFullFaceDescription(webcam.current.getScreenshot(), inputSize).then(async fullDesc => {\n        let descriptors = fullDesc.map(fd => fd.descriptor);\n\n        if (descriptors.length !== 0 && !!faceMatcher) {\n          let match = await descriptors.map(descriptor => faceMatcher.findBestMatch(descriptor));\n\n          if (match) {\n            let label = match.map(m => m._label);\n\n            if (!label.includes(\"unknown\")) {\n              setUser(label.pop());\n            }\n          }\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [user, /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(CardMedia, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Camera\",\n          style: {\n            display: \"flex\",\n            flexDirection: \"column\",\n            alignItems: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: WIDTH,\n              height: HEIGHT\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: \"relative\",\n                width: WIDTH\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  position: \"absolute\"\n                },\n                children: /*#__PURE__*/_jsxDEV(Webcam, {\n                  audio: false,\n                  width: WIDTH,\n                  height: HEIGHT,\n                  mirrored: true,\n                  ref: webcam,\n                  screenshotFormat: \"image/jpeg\",\n                  videoConstraints: videoConstraints\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: true,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"#\",\n          variant: \"body2\",\n          children: \"Se connecter via mot de passe?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: true,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/signup\",\n          variant: \"body2\",\n          children: \"Pas encore de compte ?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n}\n\n_s(FaceReco, \"ozTr5IByTFqeax5xVsd4QkuUeVQ=\", false, function () {\n  return [useFace];\n});\n\n_c = FaceReco;\n\nfunction FormLogin() {\n  _s2();\n\n  const classes = useStyles();\n  const history = useHistory();\n  const {\n    signin\n  } = useAuth();\n  const {\n    handleSubmit,\n    register\n  } = useForm();\n\n  const onSubmit = async data => {\n    await signin(data.email, data.password).then(() => {\n      history.push(\"/\");\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: classes.form,\n    onSubmit: handleSubmit(onSubmit),\n    children: [/*#__PURE__*/_jsxDEV(TextField, {\n      variant: \"outlined\",\n      margin: \"normal\",\n      required: true,\n      fullWidth: true,\n      id: \"email\",\n      ...register(\"email\"),\n      label: \"Adresse email\",\n      name: \"email\",\n      autoComplete: \"email\",\n      autoFocus: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TextField, {\n      variant: \"outlined\",\n      margin: \"normal\",\n      required: true,\n      fullWidth: true,\n      name: \"password\",\n      ...register(\"password\"),\n      label: \"Mot de passe\",\n      type: \"password\",\n      id: \"password\",\n      autoComplete: \"current-password\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n      control: /*#__PURE__*/_jsxDEV(Checkbox, {\n        value: \"remember\",\n        color: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 18\n      }, this),\n      label: \"Se rappeler\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      type: \"submit\",\n      fullWidth: true,\n      variant: \"contained\",\n      color: \"primary\",\n      className: classes.submit,\n      children: \"Se connecter\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: true,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"#\",\n          variant: \"body2\",\n          children: \"Mot de passe oubli\\xE9?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/signup\",\n          variant: \"body2\",\n          children: \"Pas encore de compte ?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(FormLogin, \"TCQfWR2iTlKmlpSU6eE+qA48JzM=\", false, function () {\n  return [useStyles, useHistory, useAuth, useForm];\n});\n\n_c2 = FormLogin;\n\nfunction SignIn() {\n  _s3();\n\n  const classes = useStyles();\n  const [isCameraAvailable, setCameraAvailable] = useState(false);\n\n  const handleVideoDevice = () => {\n    if (\"enumerateDevices\" in navigator.mediaDevices) {\n      navigator.mediaDevices.enumerateDevices().then(async devices => {\n        let inputDevice = await devices.filter(device => device.kind === \"videoinput\");\n\n        if (inputDevice.length !== 0) {\n          setCameraAvailable(true);\n        } else {\n          setCameraAvailable(false);\n        }\n      });\n    } else {\n      setCameraAvailable(false);\n    }\n  };\n\n  useEffect(() => {\n    handleVideoDevice();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    children: [/*#__PURE__*/_jsxDEV(CssBaseline, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.paper,\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {\n        className: classes.avatar,\n        children: /*#__PURE__*/_jsxDEV(LockOutlinedIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        component: \"h1\",\n        variant: \"h5\",\n        children: \"Se connecter\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }, this), isCameraAvailable ? /*#__PURE__*/_jsxDEV(FaceReco, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 28\n    }, this) : /*#__PURE__*/_jsxDEV(FormLogin, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 43\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      mt: 8,\n      children: /*#__PURE__*/_jsxDEV(Copyright, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n}\n\n_s3(SignIn, \"ASVcG+ltsFKDhWuTJGsbtppedvs=\", false, function () {\n  return [useStyles];\n});\n\n_c3 = SignIn;\nexport default SignIn;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"FaceReco\");\n$RefreshReg$(_c2, \"FormLogin\");\n$RefreshReg$(_c3, \"SignIn\");","map":{"version":3,"sources":["/Users/yolo/Documents/dev/js/faceid/src/components/Login.jsx"],"names":["React","useEffect","useState","useRef","useHistory","useForm","useAuth","useFace","loadModels","getFullFaceDescription","createMatcher","Copyright","Webcam","Avatar","Button","CssBaseline","TextField","FormControlLabel","Checkbox","Link","Grid","Box","LockOutlinedIcon","Typography","makeStyles","Container","Card","CardMedia","WIDTH","HEIGHT","inputSize","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","FaceReco","webcam","videoConstraints","height","users","faceMatcher","setFaceMatcher","user","setUser","length","then","interval","setInterval","capture","clearInterval","current","getScreenshot","fullDesc","descriptors","map","fd","descriptor","match","findBestMatch","label","m","_label","includes","pop","position","FormLogin","classes","history","signin","handleSubmit","register","onSubmit","data","email","password","push","SignIn","isCameraAvailable","setCameraAvailable","handleVideoDevice","navigator","mediaDevices","enumerateDevices","devices","inputDevice","filter","device","kind"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { useAuth } from \"../hooks/useAuth\";\nimport { useFace } from \"../hooks/useFace\";\n\nimport { loadModels, getFullFaceDescription, createMatcher } from \"../api/face\";\n\nimport Copyright from \"./Copyright\";\nimport Webcam from \"react-webcam\";\n\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Card from \"@material-ui/core/Card\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\n\nconst WIDTH = 420;\nconst HEIGHT = 420;\nconst inputSize = 160;\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main,\n  },\n  form: {\n    width: \"100%\", // Fix IE 11 issue.\n    marginTop: theme.spacing(1),\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2),\n  },\n}));\n\nfunction FaceReco() {\n  const webcam = useRef();\n  let videoConstraints = {\n    width: WIDTH,\n    height: HEIGHT,\n  };\n\n  const { users } = useFace();\n\n  const [faceMatcher, setFaceMatcher] = useState([]);\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    if (users.length !== 0 && faceMatcher.length === 0) {\n      loadModels().then(async () => {\n        setFaceMatcher(await createMatcher(users));\n      });\n    }\n    if (faceMatcher.length !== 0) {\n      const interval = setInterval(() => {\n        capture();\n      }, 500);\n      return () => clearInterval(interval);\n    }\n  }, [users, faceMatcher]);\n\n  const capture = () => {\n    if (!!webcam.current) {\n      getFullFaceDescription(webcam.current.getScreenshot(), inputSize).then(\n        async (fullDesc) => {\n          let descriptors = fullDesc.map((fd) => fd.descriptor);\n          if (descriptors.length !== 0 && !!faceMatcher) {\n            let match = await descriptors.map((descriptor) =>\n              faceMatcher.findBestMatch(descriptor)\n            );\n            if (match) {\n              let label = match.map((m) => m._label);\n              if (!label.includes(\"unknown\")) {\n                setUser(label.pop());\n              }\n            }\n          }\n        }\n      );\n    }\n  };\n\n  return (\n    <div>\n      {user}\n      <Card>\n        <CardMedia>\n          <div\n            className=\"Camera\"\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"center\",\n            }}\n          >\n            <div\n              style={{\n                width: WIDTH,\n                height: HEIGHT,\n              }}\n            >\n              <div style={{ position: \"relative\", width: WIDTH }}>\n                <div style={{ position: \"absolute\" }}>\n                  <Webcam\n                    audio={false}\n                    width={WIDTH}\n                    height={HEIGHT}\n                    mirrored\n                    ref={webcam}\n                    screenshotFormat=\"image/jpeg\"\n                    videoConstraints={videoConstraints}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </CardMedia>\n      </Card>\n      <Grid container>\n        <Grid item xs>\n          <Link href=\"#\" variant=\"body2\">\n            Se connecter via mot de passe?\n          </Link>\n        </Grid>\n        <Grid item xs>\n          <Link href=\"/signup\" variant=\"body2\">\n            {\"Pas encore de compte ?\"}\n          </Link>\n        </Grid>\n      </Grid>\n    </div>\n  );\n}\n\nfunction FormLogin() {\n  const classes = useStyles();\n\n  const history = useHistory();\n  const { signin } = useAuth();\n\n  const { handleSubmit, register } = useForm();\n\n  const onSubmit = async (data) => {\n    await signin(data.email, data.password).then(() => {\n      history.push(\"/\");\n    });\n  };\n\n  return (\n    <form className={classes.form} onSubmit={handleSubmit(onSubmit)}>\n      <TextField\n        variant=\"outlined\"\n        margin=\"normal\"\n        required\n        fullWidth\n        id=\"email\"\n        {...register(\"email\")}\n        label=\"Adresse email\"\n        name=\"email\"\n        autoComplete=\"email\"\n        autoFocus\n      />\n      <TextField\n        variant=\"outlined\"\n        margin=\"normal\"\n        required\n        fullWidth\n        name=\"password\"\n        {...register(\"password\")}\n        label=\"Mot de passe\"\n        type=\"password\"\n        id=\"password\"\n        autoComplete=\"current-password\"\n      />\n\n      <FormControlLabel\n        control={<Checkbox value=\"remember\" color=\"primary\" />}\n        label=\"Se rappeler\"\n      />\n      <Button\n        type=\"submit\"\n        fullWidth\n        variant=\"contained\"\n        color=\"primary\"\n        className={classes.submit}\n      >\n        Se connecter\n      </Button>\n      <Grid container>\n        <Grid item xs>\n          <Link href=\"#\" variant=\"body2\">\n            Mot de passe oublié?\n          </Link>\n        </Grid>\n        <Grid item>\n          <Link href=\"/signup\" variant=\"body2\">\n            {\"Pas encore de compte ?\"}\n          </Link>\n        </Grid>\n      </Grid>\n    </form>\n  );\n}\n\nfunction SignIn() {\n  const classes = useStyles();\n  const [isCameraAvailable, setCameraAvailable] = useState(false);\n\n  const handleVideoDevice = () => {\n    if (\"enumerateDevices\" in navigator.mediaDevices) {\n      navigator.mediaDevices.enumerateDevices().then(async (devices) => {\n        let inputDevice = await devices.filter(\n          (device) => device.kind === \"videoinput\"\n        );\n        if (inputDevice.length !== 0) {\n          setCameraAvailable(true);\n        } else {\n          setCameraAvailable(false);\n        }\n      });\n    } else {\n      setCameraAvailable(false);\n    }\n  };\n\n  useEffect(() => {\n    handleVideoDevice();\n  }, []);\n\n  return (\n    <Container component=\"main\" maxWidth=\"xs\">\n      <CssBaseline />\n      <div className={classes.paper}>\n        <Avatar className={classes.avatar}>\n          <LockOutlinedIcon />\n        </Avatar>\n        <Typography component=\"h1\" variant=\"h5\">\n          Se connecter\n        </Typography>\n      </div>\n      {isCameraAvailable ? <FaceReco /> : <FormLogin />}\n      <Box mt={8}>\n        <Copyright />\n      </Box>\n    </Container>\n  );\n}\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}